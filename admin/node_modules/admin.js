$(document).ready(function(){


	$('#table-users').DataTable();
	$('#table-peserta').DataTable();
	$('#table-staf').DataTable();    		
	$('#table-materi').DataTable();    		

        $.ajax({
            url : "dataset.php",
            type : "GET",
            success : function(data){
                // console.log(data.peserta);

                var bulan = [];
                var total = [];
                var hitCounter = [];

                $.each(data.peserta, function(index, value) {
                    bulan.push(value.Bulan);
                    total.push(value.Total);
                });

                // console.log(bulan, total);

               var data = {
				    labels: bulan,
				    datasets: [
				        {
				            data: total,
				            backgroundColor: [
				                "#FFCE56",
				                "#ff0f0f",
				                "#FF6384",
				                "#36A2EB"
				            ],
				            hoverBackgroundColor: [
				                "#FFCE56",
				                "#ff0f0f",
				                "#FF6384",
				                "#36A2EB"
				            ]
				        }]
				};

				var ctx = $("#lineChart");

				var myDoughnutChart = new Chart(ctx, {
				    type: 'doughnut',
				    data: data
				});
            },
            error : function(data) {
            	console.log(data);
            }
        });

        $.ajax({
        	url: 'dataset.php',
        	type: 'GET',
        	success: function (data) {
        		
        		var hitCounter = data.hitCounter,
        			mendaftar = data.mendaftar,
        			terdaftar = data.terdaftar;

        		// console.log(hitCounter, mendaftar, terdaftar);

        		var dataset = {
							    datasets: [{
							        data: [
							            hitCounter,
							            mendaftar,
							            terdaftar
							        ],
							        backgroundColor: [
							            "#FF6384",
							            "#4BC0C0",
							            "#FFCE56"
							        ],
							        label: 'My dataset' // for legend
							    }],
							    labels: [
							        "Hit Counter",
							        "Peserta Mendaftar",
							        "Peserta Terdaftar"
							    ]
							};

				var ctx = $("#polarAreaChart");

				new Chart(ctx, {
				    data: dataset,
				    type: 'polarArea'
				});

				$.ajax({
					url: 'detector.php',
					type: 'GET',
					success: function (res) {

						var OS = [],
							Browser = [],
							total = [];

						$.each(res, function(index, val) {
							 OS.push(val.OS);
							 total.push(val.count);
						});

						var uniqOS = [];
						var uniqCount = [];

						$.each(OS, function(i, el) {
                             if ($.inArray(el, uniqOS) == -1) { uniqOS.push(el) }
                        });

                        $.each(total, function(i, el) {
                             if ($.inArray(el, uniqCount) == -1) { uniqCount.push(el) }
                        });

						// console.log(uniqCount);
						var data = {
						    labels: uniqOS,
						    datasets: [
						        {
						            data: uniqCount,
						            backgroundColor: [
						                "#FF6384",
						                "#36A2EB",
						                "#FFCE56",
						                "#ff0f0f"
						            ],
						            hoverBackgroundColor: [
						                "#FF6384",
						                "#36A2EB",
						                "#FFCE56",
						                "#ff0f0f"
						            ]
						        }]
						};

						var ctx = $("#pieChart");

						var myPieChart = new Chart(ctx,{
						    type: 'pie',
						    data: data
						});
					}
				});
				
				$.ajax({
				url: "kejuruanMinat.php",
				method: "GET",
				success: function(data) {
					
					var kejuruan = [];
					var total = [];

					$.each(data, function(index, val) {
						kejuruan.push(val.KEJURUAN);
						total.push(val.TOTAL);
					});

					var chartdata = {
						labels : kejuruan,
						datasets : [{
							label : 'Minat Kejuruan',
							backgroundColor: 'rgba(200,200,200, 0.75)',
							borderColor: 'rgba(200,200,200, 0.75)',
							hoverBackgroundColor: 'rgba(200,200,200, 1)',
							hoverBorderColor: 'rgba(200,200,200, 1)',
							data : total
						}]
					}
					// console.log(chartdata);
					var ctx = $("#barChart");

					var barGraph = new Chart(ctx, {
						type: 'bar',
						data: chartdata
					});

				},
				error: function(data) {
					console.log(data);
				}
			})

        	},
            error : function(data) {
            	console.log(data);
            }
        });

        // Click Funtion pada tabel Users

		$('#users-pdf').click(function() {
	        $('#table-users').tableExport({
	            type: 'pdf',
	            escape: 'false'
	        });
	    });

	    $('#users-png').click(function(e) {
	        $('#table-users').tableExport({
	            type: 'png',
	            escape: 'false'
	        });
	    });

	    $('#users-json').click(function(e) {
	        $('#table-users').tableExport({
	            type: 'json',
	            escape: 'false'
	        });
	    });

	    $('#users-csv').click(function(e) {
	        $('#table-users').tableExport({
	            type: 'csv',
	            escape: 'false'
	        });
	    });

	    $('#users-xml').click(function(e) {
	        $('#table-users').tableExport({
	            type: 'xml',
	            escape: 'false'
	        });
	    });

	    $('#users-sql').click(function(e) {
	        $('#table-users').tableExport({
	            type: 'sql',
	            escape: 'false'
	        });
	    });

	    $('#users-word').click(function(e) {
	        $('#table-users').tableExport({
	            type: 'doc',
	            escape: 'false'
	        });
	    });

	    $('#users-excel').click(function(e) {
	        $('#table-users').tableExport({
	            type: 'excel',
	            escape: 'false'
	        });
	    });

		// Click funtion untuk tabel Peserta
		
		$('#peserta-pdf').click(function() {
	        $('#table-peserta').tableExport({
	            type: 'pdf',
	            escape: 'false'
	        });
	    });

	    $('#peserta-png').click(function(e) {
	        $('#table-peserta').tableExport({
	            type: 'png',
	            escape: 'false'
	        });
	    });

	    $('#peserta-json').click(function(e) {
	        $('#table-peserta').tableExport({
	            type: 'json',
	            escape: 'false'
	        });
	    });

	    $('#peserta-csv').click(function(e) {
	        $('#table-peserta').tableExport({
	            type: 'csv',
	            escape: 'false'
	        });
	    });

	    $('#peserta-xml').click(function(e) {
	        $('#table-peserta').tableExport({
	            type: 'xml',
	            escape: 'false'
	        });
	    });

	    $('#peserta-sql').click(function(e) {
	        $('#table-peserta').tableExport({
	            type: 'sql',
	            escape: 'false'
	        });
	    });

	    $('#peserta-word').click(function(e) {
	        $('#table-peserta').tableExport({
	            type: 'doc',
	            escape: 'false'
	        });
	    });

	    $('#peserta-excel').click(function(e) {
	        $('#table-peserta').tableExport({
	            type: 'excel',
	            escape: 'false'
	        });
	    });

	    // Click Function Staf to print
		
		$('#staf-pdf').click(function() {
	        $('#table-staf').tableExport({
	            type: 'pdf',
	            escape: 'false'
	        });
	    });

	    $('#staf-png').click(function(e) {
	        $('#table-staf').tableExport({
	            type: 'png',
	            escape: 'false'
	        });
	    });

	    $('#staf-json').click(function(e) {
	        $('#table-staf').tableExport({
	            type: 'json',
	            escape: 'false'
	        });
	    });

	    $('#staf-csv').click(function(e) {
	        $('#table-staf').tableExport({
	            type: 'csv',
	            escape: 'false'
	        });
	    });

	    $('#staf-xml').click(function(e) {
	        $('#table-staf').tableExport({
	            type: 'xml',
	            escape: 'false'
	        });
	    });

	    $('#staf-sql').click(function(e) {
	        $('#table-staf').tableExport({
	            type: 'sql',
	            escape: 'false'
	        });
	    });

	    $('#staf-word').click(function(e) {
	        $('#table-staf').tableExport({
	            type: 'doc',
	            escape: 'false'
	        });
	    });

	    $('#staf-excel').click(function(e) {
	        $('#table-staf').tableExport({
	            type: 'excel',
	            escape: 'false'
	        });
	    });

});